<div class="device-config-container">
  <!-- Column 1: Device list -->
  <div class="column devices-column">
    <div class="column-header">
      <h3>Devices</h3>
    </div>

    <div class="loading-state" *ngIf="loading">
      <wait-spinner></wait-spinner>
    </div>

    <div class="item-list" *ngIf="!loading">
      <div
        class="list-item"
        *ngFor="let deviceId of deviceIds"
        [class.selected]="selectedDeviceId === deviceId"
        (click)="onDeviceClick(deviceId)">
        {{ deviceId }}
      </div>
    </div>

    <div class="empty-state" *ngIf="!loading && deviceIds.length === 0">
      <p>No devices found</p>
    </div>
  </div>

  <!-- Column 2: Config options (Client + versions) -->
  <div class="column config-options-column">
    <div class="column-header">
      <h3>Configuration</h3>
    </div>

    <div class="no-selection" *ngIf="!selectedDeviceId">
      <p>Select a device</p>
    </div>

    <div class="loading-state" *ngIf="selectedDeviceDetails?.loading">
      <wait-spinner></wait-spinner>
    </div>

    <div class="item-list" *ngIf="selectedDeviceId && !selectedDeviceDetails?.loading && configOptions.length > 0">
      <div
        class="list-item"
        *ngFor="let option of configOptions"
        [class.selected]="selectedConfigOption?.id === option.id"
        (click)="onConfigOptionClick(option)">
        {{ option.label }}
      </div>
    </div>

    <div class="empty-state" *ngIf="selectedDeviceId && !selectedDeviceDetails?.loading && configOptions.length === 0">
      <p>No configurations available</p>
    </div>
  </div>

  <!-- Column 3: Details -->
  <div class="column details-column">
    <div class="column-header">
      <h3>Details</h3>
    </div>

    <div class="no-selection" *ngIf="!selectedConfigOption">
      <p>Select a configuration</p>
    </div>

    <div class="loading-state" *ngIf="loadingConfigDetails">
      <wait-spinner></wait-spinner>
    </div>

    <!-- Client (Detector Config) Details -->
    <div class="details-content" *ngIf="selectedConfigOption?.type === 'client' && selectedDeviceDetails?.config">
      <div class="section-title">
        <h4>{{ selectedDeviceId }} - Client Configuration</h4>
      </div>

      <div class="details-grid">
        <div class="detail-row">
          <span class="label">Element Range:</span>
          <span class="value">{{ selectedDeviceDetails.config.minElement }} - {{ selectedDeviceDetails.config.maxElement }}</span>
        </div>

        <div class="detail-row">
          <span class="label">Energy Bounds (eV):</span>
          <span class="value">{{ selectedDeviceDetails.config.xrfeVLowerBound }} - {{ selectedDeviceDetails.config.xrfeVUpperBound }}</span>
        </div>

        <div class="detail-row">
          <span class="label">Energy Resolution:</span>
          <span class="value">{{ selectedDeviceDetails.config.xrfeVResolution }} eV</span>
        </div>

        <div class="detail-row">
          <span class="label">Beam Radius:</span>
          <span class="value">{{ selectedDeviceDetails.config.mmBeamRadius }} mm</span>
        </div>

        <div class="detail-row">
          <span class="label">Elevation Angle:</span>
          <span class="value">{{ selectedDeviceDetails.config.elevAngle }}Â°</span>
        </div>

        <div class="detail-row">
          <span class="label">Window Element:</span>
          <span class="value">{{ selectedDeviceDetails.config.windowElement }}</span>
        </div>

        <div class="detail-row">
          <span class="label">Tube Element:</span>
          <span class="value">{{ selectedDeviceDetails.config.tubeElement }}</span>
        </div>

        <div class="detail-row" *ngIf="selectedDeviceDetails.config.defaultParams">
          <span class="label">Default Params:</span>
          <span class="value monospace">{{ selectedDeviceDetails.config.defaultParams }}</span>
        </div>
      </div>
    </div>

    <!-- Piquant Config (Version) Details -->
    <div class="details-content" *ngIf="selectedConfigOption?.type === 'version' && !loadingConfigDetails && piquantConfigDetails">
      <div class="section-title">
        <h4>{{ selectedDeviceId }} - {{ selectedConfigOption.label }}</h4>
      </div>

      <div class="details-grid">
        <div class="detail-row" *ngIf="piquantConfigDetails.description">
          <span class="label">Description:</span>
          <span class="value">{{ piquantConfigDetails.description }}</span>
        </div>

        <div class="detail-row" *ngIf="piquantConfigDetails.configFile">
          <span class="label">Config File:</span>
          <span class="value monospace clickable" (click)="onFileClick(piquantConfigDetails.configFile)">
            {{ piquantConfigDetails.configFile }}
          </span>
        </div>

        <div class="detail-row" *ngIf="piquantConfigDetails.opticEfficiencyFile">
          <span class="label">Optic Efficiency File:</span>
          <span class="value monospace clickable" (click)="onFileClick(piquantConfigDetails.opticEfficiencyFile)">
            {{ piquantConfigDetails.opticEfficiencyFile }}
          </span>
        </div>

        <div class="detail-row" *ngIf="piquantConfigDetails.calibrationFile">
          <span class="label">Calibration File:</span>
          <span class="value monospace clickable" (click)="onFileClick(piquantConfigDetails.calibrationFile)">
            {{ piquantConfigDetails.calibrationFile }}
          </span>
        </div>

        <div class="detail-row" *ngIf="piquantConfigDetails.standardsFile">
          <span class="label">Standards File:</span>
          <span class="value monospace clickable" (click)="onFileClick(piquantConfigDetails.standardsFile)">
            {{ piquantConfigDetails.standardsFile }}
          </span>
        </div>
      </div>
    </div>

    <!-- Error state for failed piquant config load -->
    <div class="no-config" *ngIf="selectedConfigOption?.type === 'version' && !loadingConfigDetails && !piquantConfigDetails">
      <p>Failed to load configuration details</p>
    </div>
  </div>
</div>
